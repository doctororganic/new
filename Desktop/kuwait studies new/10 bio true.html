10 bio true.html

import React, { useState, useEffect } from 'react';
import { 
  CheckCircle, XCircle, HelpCircle, Timer, Trophy, BookOpen, 
  ChevronLeft, ChevronRight, Play, RotateCcw, ExternalLink, Gift, Check 
} from 'lucide-react';

// جميع الأجزاء مفتوحة الآن (بدون قفل)
const BLOCKS = [
  {
    id: 1,
    title: "الوحدة 1: مقدمة في الخلية",
    questions: [
      { q: "ما المقصود بالخلية؟", o: ["أصغر وحدة بناء في الجسم الحي", "جزء من العضو", "مجموعة أنسجة", "وحدة وظيفية فقط"], c: 0, e: "الخلية هي أصغر وحدة بنائية ووظيفية في الكائن الحي، وتقوم بجميع العمليات الحيوية.", t: "الخلية" },
      { q: "من اكتشف الخلية لأول مرة؟", o: ["لوس فالك", "روبرت هوك", "أرسطو", "داروين"], c: 1, e: "روبرت هوك اكتشف الخلايا سنة 1665 عند فحصه شريحة فلين تحت المجهر، وسماها 'خلايا' لأنها تشبه خلايا النحل.", t: "الخلية" },
      { q: "أي من التالي ينطبق على النظرية الخلوية؟", o: ["كل الكائنات الحية مكونة من خلية واحدة فقط", "الخلية تنشأ من خلية أخرى", "الخلية لا تحتوي على مادة وراثية", "الخلية لا تنمو"], c: 1, e: "إحدى مبادئ النظرية الخلوية: 'تنشأ الخلية من خلية أخرى منقسمة'، أي لا تخلق من العدم.", t: "الخلية" },
      { q: "ما الفرق بين الخلايا البدائية والحقيقية النوى؟", o: ["البدائية تحتوي نواة، والحقيقية لا", "الحقيقية تحتوي نواة محاطة بغشاء، والبدائية لا", "البدائية أكبر حجمًا", "الحقيقية لا تحتوي عضيات"], c: 1, e: "الخلايا الحقيقية النوى (Eukaryotic) تمتلك نواة محاطة بغشاء، بينما الخلايا البدائية (Prokaryotic) لا نواة لها، ومادتها الوراثية حرة في السيتوبلازم.", t: "الخلية" },
      { q: "أين توجد المادة الوراثية في البكتيريا؟", o: ["في النواة", "في الميتوكندريا", "في السيتوبلازم", "في الريبوسوم"], c: 2, e: "في الخلايا البدائية مثل البكتيريا، توجد المادة الوراثية (DNA دائري) حرة في السيتوبلازم، وليس داخل نواة.", t: "الخلية" },
      { q: "أي كائن حي يمتلك خلايا بدائية؟", o: ["النبات", "الحيوان", "الفطر", "البكتيريا"], c: 3, e: "البكتيريا والطحالب الخضراء المزرقة (السيانوبكتيريا) هي كائنات بدائية النوى.", t: "الخلية" },
      { q: "ما اسم الغشاء الذي يحيط بالخلية؟", o: ["الغشاء النووي", "الغشاء البلازمي", "غشاء الميتوكندريا", "غشاء الشبكة الإندوبلازمية"], c: 1, e: "الغشاء البلازمي (السيتوبلازمي) هو الغشاء الخارجي الذي يحيط بالخلية، وينظم دخول وخروج المواد.", t: "الخلية" },
      { q: "أي مما يلي من وظائف الغشاء البلازمي؟", o: ["إعطاء شكل ثابت للخلية الحيوانية", "حماية الخلية وتحديد ما يدخل ويخرج", "تخزين الماء", "تصنيع البروتين"], c: 1, e: "الغشاء البلازمي شبه منفذ، وظيفته تنظيم مرور المواد (اختياري)، وحماية محتويات الخلية.", t: "الخلية" },
      { q: "ما المقصود بـ 'شبه منفذ' بالنسبة للغشاء البلازمي؟", o: ["يسمح بمرور كل المواد", "لا يسمح بمرور أي مواد", "يسمح بمرور بعض المواد دون أخرى", "يسمح بمرور الماء فقط"], c: 2, e: "شبه منفذ = انتقائي، يسمح بمرور مواد محددة (مثل الماء، الأيونات الصغيرة) ويمنع أخرى (مثل الجزيئات الكبيرة).", t: "الخلية" },
      { q: "أين توجد الريبوسومات في الخلية؟", o: ["فقط في النواة", "في السيتوبلازم وملتصقة بالشبكة الإندوبلازمية", "داخل الميتوكندريا فقط", "في الغشاء البلازمي"], c: 1, e: "الريبوسومات توجد حرة في السيتوبلازم أو ملتصقة بالشبكة الإندوبلازمية الخشنة، وتقوم بتصنيع البروتين.", t: "الخلية" },
      { q: "ما اسم العضية المسؤولة عن تصنيع البروتينات؟", o: ["الميتوكندريا", "الجسيمات الحالة", "الريبوسوم", "جهاز غولجي"], c: 2, e: "الريبوسومات هي مواقع تصنيع البروتين في الخلية، وتتكون من RNA وبروتين.", t: "الخلية" }
    ]
  },
  {
    id: 2,
    title: "الوحدة 1: عضيات الخلية (1)",
    questions: [
      { q: "ما وظيفة النواة في الخلية؟", o: ["تصنيع الطاقة", "تخزين المؤثرات الوراثية والتحكم في أنشطة الخلية", "هضم المواد", "إعطاء شكل للخلية"], c: 1, e: "النواة تحتوي على DNA (المؤثرات الوراثية)، وتتحكم في نمو الخلية وانقسامها وتصنيع البروتينات.", t: "الخلية" },
      { q: "ما اسم الغشاء المحيط بالنواة؟", o: ["غشاء مفرد", "غشاء مزدوج به ثقوب", "غشاء بلاستيدي", "غشاء ميتوكندري"], c: 1, e: "الغشاء النووي مزدوج (غشائين)، ويتخلله ثقوب تسمح بمرور RNA والبروتينات بين النواة والسيتوبلازم.", t: "الخلية" },
      { q: "أين تصنع وحدات الريبوسوم؟", o: ["في الشبكة الإندوبلازمية", "في جهاز غولجي", "في النوية داخل النواة", "في الميتوكندريا"], c: 2, e: "النوية (Nucleolus) داخل النواة هي المكان الذي تُصنع فيه وحدات الريبوسوم (rRNA + بروتين).", t: "الخلية" },
      { q: "ما وظيفة الميتوكندريا؟", o: ["تصنيع البروتين", "هضم المواد", "إنتاج الطاقة (ATP)", "تخزين الماء"], c: 2, e: "الميتوكندريا تُسمى 'محطة توليد الطاقة' لأنها تنتج ATP عبر التنفس الخلوي الهوائي.", t: "الخلية" },
      { q: "لماذا تسمى الميتوكندريا 'شبه مستقلة'؟", o: ["لأنها لا تحتاج أكسجين", "لأنها تحتوي DNA وريبوسومات خاصة بها", "لأنها تصنع كل بروتيناتها", "لأنها لا تتصل بالشبكة الإندوبلازمية"], c: 1, e: "الميتوكندريا تحتوي على DNA دائري خاص وريبوسومات، مما يدعم نظرية الاندماج الداخلي.", t: "الخلية" },
      { q: "ما اسم العضية التي تحتوي إنزيمات هاضمة؟", o: ["الميتوكندريا", "الجسيمات الحالة", "الشبكة الإندوبلازمية", "الريبوسوم"], c: 1, e: "الجسيمات الحالة تحتوي على إنزيمات هاضمة (مثل الليباز، البروتيز) لتدمير المواد غير المرغوب فيها.", t: "الخلية" },
      { q: "ما تأثير تلف الجسيمات الحالة على الخلية؟", o: ["توقف إنتاج الطاقة", "تراكم المواد الضارة داخل الخلية", "اختفاء النواة", "انفجار الخلية"], c: 1, e: "إذا تلفت الجسيمات الحالة، لا تُهضم المواد القديمة أو الميكروبات، فتتراكم وتسبب أمراضًا (مثل مرض التاي-ساسكس).", t: "الخلية" },
      { q: "أي عضية مسؤولة عن تعديل وتغليف البروتينات؟", o: ["الشبكة الإندوبلازمية الخشنة", "جهاز غولجي", "الميتوكندريا", "النواة"], c: 1, e: "جهاز غولجي يستقبل البروتينات من RER، يعدلها (مثل إضافة سكريات)، ثم يغلفها في حويصلات للإفراز أو الاستخدام.", t: "الخلية" },
      { q: "ما اسم الحويصلات التي تنقل البروتين من RER إلى جهاز غولجي؟", o: ["حويصلات طلائعية", "حويصلات منقولة", "حويصلات غشائية", "لا اسم خاص"], c: 0, e: "تُسمى الحويصلات التي تنقل البروتين من RER إلى جهاز غولجي بـ 'الحويصلات الطلائعية' (Vesicles).", t: "الخلية" },
      { q: "ما وظيفة الشبكة الإندوبلازمية الملساء؟", o: ["تصنيع البروتين", "تصنيع الدهون وتنقية السموم", "هضم المواد", "تخزين الكالسيوم فقط"], c: 1, e: "الشبكة الإندوبلازمية الملساء (SER) تصنع الدهون (مثل الهرمونات)، وتنقي السموم (خاصة في خلايا الكبد)، وتخزن أيونات الكالسيوم.", t: "الخلية" },
      { q: "أين توجد الشبكة الإندوبلازمية الملساء بكثرة؟", o: ["في خلايا البنكرياس", "في خلايا الكبد", "في خلايا العضلات", "في كليهما (ب و ج)"], c: 3, e: "توجد بكثرة في خلايا الكبد (لتنقية السموم) وخلايا العضلات (لتخزين الكالسيوم الضروري للانقباض).", t: "الخلية" }
    ]
  },
  {
    id: 3,
    title: "الوحدة 1: عضيات الخلية (2)",
    questions: [
      { q: "ما الفرق بين الخلايا النباتية والحيوانية؟", o: ["النباتية تحتوي جدار خلوي وميتوكندريا، والحيوانية لا", "النباتية تحتوي جدار خلوي وبلاستيدات خضراء، والحيوانية لا", "الحيوانية تحتوي فجوة مركزية كبيرة، والنباتية لا", "الحيوانية تحتوي على نواة، والنباتية لا"], c: 1, e: "الخلايا النباتية تتميز بوجود جدار خلوي (من سيليلوز) وبلاستيدات خضراء (لعملية البناء الضوئي)، بينما الخلايا الحيوانية لا تملكها.", t: "الخلية" },
      { q: "ما وظيفة الجدار الخلوي في النبات؟", o: ["إعطاء شكل ودعم ميكانيكي ومنع الانفجار", "تنظيم دخول المواد", "تصنيع البروتين", "تخزين الطاقة"], c: 0, e: "الجدار الخلوي (من السيليلوز) يعطي الدعم والصلابة، ويمنع انفجار الخلية عند دخول الماء (في المحاليل قليلة التوتر).", t: "الخلية" },
      { q: "ما اسم الصبغة في البلاستيدات الخضراء التي تمتص الضوء؟", o: ["الكاروتين", "الزانثوفيل", "الكلوروفيل", "الأنثوسيانين"], c: 2, e: "الكلوروفيل أ هو الصبغة الرئيسية التي تمتص الضوء الأحمر والأزرق لاستخدامه في البناء الضوئي.", t: "الخلية" },
      { q: "ما وظيفة الفجوة المركزية في الخلية النباتية؟", o: ["هضم المواد", "تخزين الماء والأملاح وتنظيم الانتفاخ", "إنتاج الطاقة", "تصنيع البروتين"], c: 1, e: "الفجوة المركزية تخزن الماء، الأملاح، الأصباغ، وتساعد في الحفاظ على ضغط الانتفاخ (Turgor Pressure).", t: "الخلية" },
      { q: "أين توجد البلاستيدات في الخلية؟", o: ["في جميع الخلايا", "في الخلايا النباتية فقط", "في الخلايا الحيوانية فقط", "في البكتيريا فقط"], c: 1, e: "البلاستيدات (مثل البلاستيدات الخضراء) توجد فقط في الخلايا النباتية وبعض الطلائعيات، ولا توجد في الخلايا الحيوانية.", t: "الخلية" },
      { q: "ما اسم البلاستيدة التي تخزن النشا؟", o: ["البلاستيدة الخضراء", "البلاستيدة البيضاء (اللبنية)", "البلاستيدة الصفراء", "الميتوكندريا"], c: 1, e: "البلاستيدات البيضاء (Leucoplasts) تختص بتخزين النشا (Amyloplasts) أو الدهون أو البروتين.", t: "الخلية" },
      { q: "ما تأثير غياب الجدار الخلوي على الخلية النباتية في محلول نقي؟", o: ["تنتفخ وتنفجر مثل الخلية الحيوانية", "لا يتأثر حجمها", "تتقلص", "تتوقف عن العمل"], c: 0, e: "بدون جدار خلوي، الخلية النباتية تصبح مثل الحيوانية، فتدخل الماء في المحاليل قليلة التوتر فتنتفخ وتنفجر (تحلل).", t: "الخلية" },
      { q: "أي خلية تحتوي على أعداد كبيرة من الميتوكندريا؟", o: ["خلية جلد", "خلية دهنية", "خلية عضلية", "خلية عظمية"], c: 2, e: "الخلايا العضلية تحتاج طاقة عالية للانقباض، لذا تحتوي على أعداد كبيرة من الميتوكندريا.", t: "الخلية" },
      { q: "ما اسم العضية التي تصنع ATP في النبات؟", o: ["البلاستيدة الخضراء فقط", "الميتوكندريا فقط", "كليهما", "الشبكة الإندوبلازمية"], c: 2, e: "البلاستيدة الخضراء تصنع ATP خلال البناء الضوئي، لكن الميتوكندريا تصنع ATP خلال التنفس الخلوي — وكلاهما موجود في الخلية النباتية.", t: "الخلية" },
      { q: "ما اسم عملية انقسام السيتوبلازم في الخلية الحيوانية؟", o: ["الانشطار الثنائي", "الانقسام المتساوي", "الانقسام الميكروزي", "التحزيم"], c: 3, e: "في الخلايا الحيوانية، ينقسم السيتوبلازم بعملية 'التحزيم' (Cleavage Furrow) بواسطة حلقة أكتين.", t: "الخلية" },
      { q: "ما اسم عملية انقسام السيتوبلازم في الخلية النباتية؟", o: ["التحزيم", "تشكيل الصفيحة الخلوية", "الانشطار", "الانفصال"], c: 1, e: "في النبات، تتشكل 'الصفيحة الخلوية' من حويصلات جهاز غولجي لتُكوّن الجدار الخلوي الجديد.", t: "الخلية" }
    ]
  },
  // ... (البقية بدون تغيير - الأجزاء 4-10 كما في الإصدار السابق)
  {
    id: 4,
    title: "الوحدة 2: الانتشار والاسموز (1)",
    questions: [
      { q: "ما المقصود بالانتشار (Diffusion)؟", o: ["حركة الماء عبر غشاء شبه منفذ", "حركة الجزيئات من تركيز منخفض لمرتفع باستخدام طاقة", "حركة الجزيئات من تركيز مرتفع لمنخفض دون طاقة", "دخول الجزيئات الكبيرة بالبلعمة"], c: 2, e: "الانتشار هو حركة جزيئات المادة (مثل O₂, CO₂) من منطقة تركيز عالٍ إلى منخفض دون استهلاك طاقة (نقل سلبي).", t: "حركة المواد" },
      { q: "أي من التالي مثال على الانتشار؟", o: ["خروج ثاني أكسيد الكربون من الخلايا", "دخول الجلوكوز إلى الأمعاء", "امتصاص الماء في الجذور", "دخول الأكسجين إلى الدم"], c: 3, e: "دخول الأكسجين من الحويصلات الهوائية (عالية التركيز) إلى الدم (منخفض التركيز) هو انتشار بحت.", t: "حركة المواد" },
      { q: "ما العوامل التي تزيد سرعة الانتشار؟", o: ["انخفاض درجة الحرارة", "زيادة حجم الجزيء", "زيادة الفرق في التركيز", "زيادة المسافة"], c: 2, e: "كلما زاد الفرق في التركيز (التدرج)، زادت سرعة الانتشار. كما تزيد الحرارة (لزيادة طاقة الجزيئات) وتقل مع كبر حجم الجزيء.", t: "حركة المواد" },
      { q: "ما المقصود بالاسموز (Osmosis)؟", o: ["انتشار الأملاح", "انتشار الجزيئات الكبيرة", "انتشار الماء عبر غشاء شبه منفذ", "نقل نشط للأيونات"], c: 2, e: "الاسموز هو انتشار الماء فقط من منطقة تركيز منخفض للمذاب (عالية للماء) إلى منطقة تركيز مرتفع للمذاب (منخفضة للماء).", t: "حركة المواد" },
      { q: "في أي اتجاه يتحرك الماء خلال الاسموز؟", o: ["من محلول مفرط التوتر إلى قليل التوتر", "من محلول قليل التوتر إلى مفرط التوتر", "من محلول متساوي التوتر إلى مفرط", "لا يتحرك"], c: 1, e: "الماء يتحرك دائمًا من المحاليل قليلة التوتر (أقل مذاب) إلى مفرطة التوتر (أكثر مذاب) عبر الغشاء شبه المنفذ.", t: "حركة المواد" },
      { q: "ما المقصود بـ 'محلول مفرط التوتر'؟", o: ["محلول تركيز مذابه أقل من الخلية", "محلول تركيز مذابه أعلى من الخلية", "محلول متساوي التركيز", "محلول لا يحتوي مذاب"], c: 1, e: "محلول مفرط التوتر (Hypertonic) تركيز مذابه أعلى من داخل الخلية، لذا يخرج الماء من الخلية.", t: "حركة المواد" },
      { q: "ما المقصود بـ 'محلول قليل التوتر'؟", o: ["محلول تركيز مذابه أعلى من الخلية", "محلول تركيز مذابه أقل من الخلية", "محلول متساوي", "محلول ملحي"], c: 1, e: "محلول قليل التوتر (Hypotonic) تركيز مذابه أقل من داخل الخلية، لذا يدخل الماء إلى الخلية.", t: "حركة المواد" },
      { q: "ما تأثير المحلول مفرط التوتر على خلية حيوانية؟", o: ["تنتفخ وتنفجر", "تفقد الماء وتتقلص (Crenation)", "لا يتأثر حجمها", "تتضخم دون انفجار"], c: 1, e: "الخلية الحيوانية بدون جدار خلوي تفقد الماء في المحاليل مفرطة التوتر، فتتقلص وتأخذ شكل مُسنّن (Crenation).", t: "حركة المواد" },
      { q: "ما تأثير المحلول مفرط التوتر على خلية نباتية؟", o: ["تنفجر", "تحدث ظاهرة الانكماش السيتوبلازمي", "تنتفخ", "لا يتأثر شكلها"], c: 1, e: "في المحاليل مفرطة التوتر، يخرج الماء من الخلية النباتية، فينفصل الغشاء السيتوبلازمي عن الجدار (انكماش سيتوبلازمي).", t: "حركة المواد" },
      { q: "ماذا يحدث لخلية حيوانية في محلول قليل التوتر؟", o: ["تفقد الماء", "تدخل الماء فتنتفخ وتنفجر (تحلل)", "تبقى مستقرة", "تتجمد"], c: 1, e: "الماء يدخل الخلية الحيوانية (لأن تركيز المذاب داخلها أعلى)، فتنتفخ ثم تنفجر (تحلل - Lysis).", t: "حركة المواد" },
      { q: "لماذا لا تنفجر الخلية النباتية في المحاليل قليلة التوتر؟", o: ["لأنها لا تمتص الماء", "بسبب وجود الجدار الخلوي الصلب", "لأن غشائها غير منفذ", "لأنها تفرز الماء"], c: 1, e: "الجدار الخلوي الصلب يقاوم ضغط الانتفاخ، فيزداد الضغط (Turgor) لكن الخلية لا تنفجر — بل تصبح منتفخة (Turgid).", t: "حركة المواد" }
    ]
  },
  {
    id: 5,
    title: "الوحدة 2: الانتشار والاسموز (2)",
    questions: [
      { q: "ما اسم الضغط الناتج عن دخول الماء إلى الخلية النباتية؟", o: ["الضغط الجاذبي", "ضغط الانتفاخ (Turgor Pressure)", "الضغط الأسموزي", "الضغط الهيدروستاتيكي"], c: 1, e: "ضغط الانتفاخ هو الضغط الذي يدفع الغشاء السيتوبلازمي على الجدار الخلوي، وهو ضروري لاستقامة النبات.", t: "حركة المواد" },
      { q: "ما المقصود بالضغط الأسموزي؟", o: ["الضغط الناتج عن دخول الماء", "أقل ضغط مطلوب لمنع الاسموز", "الضغط داخل الفجوة", "ضغط الهواء في النبات"], c: 1, e: "الضغط الأسموزي هو أقل ضغط يُطبق على المحلول المركز لمنع دخول الماء إليه عبر الغشاء شبه المنفذ.", t: "حركة المواد" },
      { q: "أي خاصية للغشاء تجعل الاسموز ممكنًا؟", o: ["كونه غير منفذ", "كونه منفذًا لجميع المواد", "كونه شبه منفذ", "كونه مصنوعًا من بروتين"], c: 2, e: "الغشاء شبه المنفذ يسمح بمرور الماء (الجزيئات الصغيرة) ويمنع مرور المذاب (الجزيئات الكبيرة أو الأيونات)، فيحدث الاسموز.", t: "حركة المواد" },
      { q: "ما تأثير إضافة الملح إلى الخضروات في تجفيفها؟", o: ["يزيد من امتصاص الماء", "يمنع الاسموز", "يخلق محلولًا مفرط التوتر فيسحب الماء من الخلايا", "يحفز النمو"], c: 2, e: "إضافة الملح تخلق محلولًا مفرط التوتر خارج خلايا الخضروات، فيخرج الماء منها بالاسموز — فيجف.", t: "حركة المواد" },
      { q: "لماذا تذبل النباتات عند نقص الماء في التربة؟", o: ["لأن الجذور تمتص الملح", "لأن التربة تصبح مفرطة التوتر فتفقد الخلايا الماء", "لأن درجة الحرارة ترتفع", "لأن الضوء يقل"], c: 1, e: "عند جفاف التربة، تصبح أكثر تركيزًا (مفرطة التوتر)، فيخرج الماء من جذور النبات بالاسموز، فتفقد الخلايا ضغط الانتفاخ فتذبل.", t: "حركة المواد" },
      { q: "ما اسم الظاهرة التي تحدث عند وضع خلية نباتية في محلول قليل التوتر؟", o: ["الانكماش السيتوبلازمي", "التحلل", "الانتفاخ", "الاستقرار"], c: 2, e: "الخلية النباتية تنتفخ (Turgid) بسبب دخول الماء، ويصبح ضغط الانتفاخ عاليًا — وهذه الحالة طبيعية وصحية.", t: "حركة المواد" },
      { q: "أي تجربة تثبت حدوث الاسموز؟", o: ["وضع قطعة بطاطس في ماء نقي", "وضع قطعة لحم في ماء مالح", "وضع بيضة منزوعة القشرة في ماء نقي", "جميع ما سبق"], c: 3, e: "جميع التجارب تُظهر الاسموز: البطاطس تنتفخ، اللحم يجف، البيضة تنتفخ وتنفجر — بسبب حركة الماء عبر الأغشية.", t: "حركة المواد" },
      { q: "ما سبب تجعد الخوخ عند تجفيفه؟", o: ["فقدان الماء بالاسموز إلى الهواء", "دخول الماء من الهواء", "تحلل الجدار الخلوي", "زيادة الضغط الأسموزي"], c: 0, e: "عند التجفيف، يتبخر الماء من سطح الخوخ، فيصبح تركيز المذاب خارجه أعلى، فيخرج الماء من الخلايا بالاسموز، فتتجعد.", t: "حركة المواد" },
      { q: "ما العلاقة بين تركيز المحلول وضغطه الأسموزي؟", o: ["علاقة عكسية", "لا توجد علاقة", "علاقة طردية", "علاقة خطية فقط"], c: 2, e: "كلما زاد تركيز المحلول، زاد الضغط الأسموزي المطلوب لمنع دخول الماء — أي علاقة طردية.", t: "حركة المواد" },
      { q: "لماذا لا تتأثر الخلايا الحيوانية كثيرًا بتغيرات ضغط الدم البسيطة؟", o: ["لأنها محاطة بجدار صلب", "لأن بلازما الدم متساوية التوتر مع الخلايا", "لأنها لا تحتوي ماء", "لأنها تستخدم النقل النشط"], c: 1, e: "بلازما الدم مُعدّة لتكون متساوية التوتر (Isotonic) مع الخلايا، فلا يدخل أو يخرج ماء — فيظل الحجم ثابتًا.", t: "حركة المواد" },
      { q: "ما اسم المحلول الذي لا يسبب تغيرًا في حجم الخلية؟", o: ["مفرط التوتر", "قليل التوتر", "متساوي التوتر", "محاليل مفرطة الترسب"], c: 2, e: "المحلول متساوي التوتر (Isotonic) له نفس تركيز المذاب داخل الخلية، فلا يحدث انتقال صافٍ للماء.", t: "حركة المواد" }
    ]
  },
  {
    id: 6,
    title: "الوحدة 2: النقل النشط والعمليات الأخرى",
    questions: [
      { q: "ما الفرق بين النقل السلبي والنشط؟", o: ["السلبي يحتاج طاقة، والنشط لا", "النشط يحدث مع التدرج، والسلبي ضد", "النشط يحتاج طاقة ويحدث ضد التدرج، والسلبي لا يحتاج طاقة ومع التدرج", "لا فرق"], c: 2, e: "النقل النشط يحتاج طاقة (ATP) ويحرك المواد ضد تدرج التركيز (من قليل لمرتفع)، بينما السلبي (مثل الانتشار) لا يحتاج طاقة ومع التدرج.", t: "حركة المواد" },
      { q: "أي مما يلي مثال على النقل النشط؟", o: ["انتشار الأكسجين", "الاسموز", "ضخ أيونات الصوديوم والبوتاسيوم", "خروج ثاني أكسيد الكربون"], c: 2, e: "مضخة الصوديوم-البوتاسيوم تضخ 3 Na⁺ خارج الخلية و2 K⁺ داخلها ضد التدرج، باستخدام ATP — نقل نشط أولي.", t: "حركة المواد" },
      { q: "ما اسم العملية التي تدخل بها الجزيئات الكبيرة كالبروتينات؟", o: ["الانتشار", "الاسموز", "البلعمة", "النقل النشط"], c: 2, e: "البلعمة (Phagocytosis) هي نوع من النقل النشط حيث تلتف الخلية حول جزيء كبير (مثل البكتيريا) لابتلاعه.", t: "حركة المواد" },
      { q: "ما اسم العملية التي تدخل بها السوائل والجزيئات الذائبة؟", o: ["البلعمة", "البلعمة السائلة (Pinocytosis)", "الانتشار", "الاسموز"], c: 1, e: "البلعمة السائلة (Pinocytosis) هي ابتلاع السوائل والجزيئات الذائبة الصغيرة — 'شرب الخلية'.", t: "حركة المواد" },
      { q: "ما اسم العملية التي تخرج بها الخلية المواد (مثل الهرمونات)؟", o: ["الانصهار", "الإفراز الخلوي (Exocytosis)", "البلعمة", "الاسموز"], c: 1, e: "الإفراز الخلوي: تندمج الحويصلات مع الغشاء البلازمي وتفرغ محتوياتها خارج الخلية (مثل الإنسولين من خلايا البنكرياس).", t: "حركة المواد" },
      { q: "أين تحدث مضخة الصوديوم-البوتاسيوم؟", o: ["في جميع الخلايا الحية", "في خلايا العضلات فقط", "في الخلايا العصبية فقط", "في الخلايا النباتية فقط"], c: 0, e: "المضخة توجد في جميع الخلايا الحيوانية (وبعض النباتية)، وضرورية للحفاظ على الجهد الغشائي.", t: "حركة المواد" },
      { q: "ما تأثير مادة السيانيد على النقل النشط؟", o: ["يزيد الطاقة", "يوقف إنتاج ATP فيوقف النقل النشط", "يحفز الانتشار", "لا يؤثر"], c: 1, e: "السيانيد يثبط سلسلة نقل الإلكترون في الميتوكندريا، فيتوقف إنتاج ATP، فيتوقف النقل النشط.", t: "حركة المواد" },
      { q: "ما اسم النقل النشط الذي يعتمد على تدرج أيون آخر؟", o: ["النقل النشط الأولي", "النقل النشط الثانوي", "الانتشار الميسر", "الاسموز"], c: 1, e: "النقل النشط الثانوي (مثل امتصاص الجلوكوز مع Na⁺) يستخدم الطاقة المخزنة في تدرج Na⁺ (المُنشأ بالنقل الأولي).", t: "حركة المواد" },
      { q: "أي من التالي لا يحتاج طاقة؟", o: ["النقل النشط", "البلعمة", "الانتشار الميسر", "الإفراز الخلوي"], c: 2, e: "الانتشار الميسر (Facilitated Diffusion) يستخدم قنوات أو نواقل بروتينية، لكنه مع التدرج ولا يحتاج طاقة.", t: "حركة المواد" },
      { q: "ما وظيفة البروتينات الناقلة في الغشاء؟", o: ["إعطاء شكل للغشاء", "نقل المواد عبر الغشاء (نشط أو سلبي)", "تصنيع الدهون", "هضم المواد"], c: 1, e: "البروتينات الناقلة (Carrier/Channel) تسمح بمرور أيونات أو جزيئات معينة (مثل الجلوكوز، Na⁺) عبر الغشاء.", t: "حركة المواد" },
      { q: "لماذا تحتاج الخلايا العصبية إلى مضخة Na⁺/K⁺؟", o: ["لتوليد جهد الفعل", "لتصنيع البروتين", "لهضم النواقل العصبية", "لتخزين الكالسيوم"], c: 0, e: "المضخة تحافظ على التدرج: تركيز عالي لـ K⁺ داخل الخلية وNa⁺ خارجها، وهو ضروري لتوليد جهد الفعل العصبي.", t: "حركة المواد" }
    ]
  },
  {
    id: 7,
    title: "الوحدة 3: الإنزيمات (1)",
    questions: [
      { q: "ما المقصود بالإنزيمات؟", o: ["بروتينات تسرّع التفاعلات الكيميائية دون استهلاك", "جزيئات تنتج طاقة", "أحماض نووية", "دهون منشطة"], c: 0, e: "الإنزيمات محفزات حيوية (معظمها بروتينات) تسرّع التفاعلات دون أن تستهلك أو تغير من نواتجها.", t: "الإنزيمات" },
      { q: "ما اسم الجزيء الذي يرتبط بالإنزيم؟", o: ["المنتج", "الركيزة", "المثبط", "المنشط"], c: 1, e: "الركيزة (Substrate) هي المادة التي يرتبط بها الإنزيم في موقعه الفعّال ليحوّلها إلى منتجات.", t: "الإنزيمات" },
      { q: "ما اسم النظرية التي تفسر تفاعل الإنزيم مع الركيزة؟", o: ["نظرية الجزيئات المتحركة", "نظرية القفل والمفتاح", "نظرية الانتقال", "نظرية التوازن"], c: 1, e: "نظرية القفل والمفتاح: شكل الموقع الفعّال في الإنزيم يتناسب بدقة مع شكل الركيزة — مثل المفتاح والقفل.", t: "الإنزيمات" },
      { q: "ما تأثير ارتباط الركيزة بالإنزيم؟", o: ["يغير شكل الإنزيم دائمًا", "يشكّل معقد إنزيم-ركيزة مؤقت", "يدمر الإنزيم", "يقلل من سرعة التفاعل"], c: 1, e: "يرتبط الإنزيم بالركيزة ليشكّل 'معقد إنزيم-ركيزة' مؤقت، ثم يتفكك إلى إنزيم + منتجات.", t: "الإنزيمات" },
      { q: "لماذا الإنزيمات محددة في عملها؟", o: ["لأنها كبيرة الحجم", "لأن شكل الموقع الفعّال يتناسب مع ركيزة محددة", "لأنها تحتاج درجة حرارة عالية", "لأنها قابلة للذوبان"], c: 1, e: "التحديد يعود لشكل الموقع الفعّال الفريد لكل إنزيم، الذي يرتبط بركيزة واحدة أو مجموعة محدودة.", t: "الإنزيمات" },
      { q: "ما اسم التفاعل الذي يحطم فيه الإنزيم الجزيئات الكبيرة؟", o: ["توليف", "هدم", "أكسدة", "اختزال"], c: 1, e: "الإنزيمات الهادمة (مثل الأميليز، البروتيز) تحطم الجزيئات الكبيرة إلى وحدات أصغر (هضم).", t: "الإنزيمات" },
      { q: "ما اسم التفاعل الذي يبني فيه الإنزيم جزيئات كبيرة؟", o: ["هدم", "توليف", "تحلل", "انتقال"], c: 1, e: "الإنزيمات البنّاءة (مثل DNA بوليميراز) تكوّن جزيئات كبيرة من وحدات أصغر (توليف).", t: "الإنزيمات" },
      { q: "أي من التالي إنزيم هادم؟", o: ["ATP سينثيز", "الأميليز", "الليباز", "كل ما سبق"], c: 3, e: "الأميليز يهضم النشا، والليباز يهضم الدهون، وATP سينثيز في الواقع يُصنّع ATP (توليف)، لكن في بعض السياقات يُستخدم عكسيًا — لكن في المنهج الكويتي، الأميليز والليباز هادمان.", t: "الإنزيمات" },
      { q: "ما وظيفة إنزيم الكاتاليز؟", o: ["هضم البروتين", "تحليل بيروكسيد الهيدروجين إلى ماء وأكسجين", "هضم النشا", "تصنيع الدهون"], c: 1, e: "الكاتاليز يحطم بيروكسيد الهيدروجين (H₂O₂) السام إلى ماء وأكسجين — موجود بكثرة في الكبد.", t: "الإنزيمات" },
      { q: "أين يوجد إنزيم البيبسين؟", o: ["في اللعاب", "في المعدة", "في الأمعاء", "في البنكرياس"], c: 1, e: "البيبسين يفرز في المعدة (في صورة غير نشطة: بيبسينوجين) ويهضم البروتين في وسط حمضي.", t: "الإنزيمات" },
      { q: "ما اسم الصورة غير النشطة من الإنزيم؟", o: ["الركيزة", "المنشط", "الزيموجين", "المثبط"], c: 2, e: "الزيموجين (Zymogen) هو الصورة غير النشطة (مثل التربسينوجين)، تتحول إلى نشطة عند الحاجة لمنع هضم الأنسجة.", t: "الإنزيمات" }
    ]
  },
  {
    id: 8,
    title: "الوحدة 3: الإنزيمات (2)",
    questions: [
      { q: "ما تأثير زيادة درجة الحرارة على نشاط الإنزيم (ضمن الحدود الطبيعية)؟", o: ["ينخفض النشاط", "يرتفع النشاط بسبب زيادة التصادمات", "لا يؤثر", "يتوقف فورًا"], c: 1, e: "مع ارتفاع الحرارة (حتى 40°م)، تزداد حركة الجزيئات ويزيد تصادم الإنزيم بالركيزة، فيرتفع النشاط.", t: "الإنزيمات" },
      { q: "ما درجة الحرارة القصوى لنشاط معظم الإنزيمات البشرية؟", o: ["25°م", "37°م", "45°م", "60°م"], c: 1, e: "درجة حرارة الجسم الطبيعية (37°م) هي المثلى لمعظم الإنزيمات البشرية.", t: "الإنزيمات" },
      { q: "ماذا يحدث للإنزيم عند ارتفاع الحرارة فوق 60°م؟", o: ["يصبح أسرع", "يتغير شكله ويتعطل (يُ denature)", "يزداد تركيزه", "يتحول إلى ركيزة"], c: 1, e: "الحرارة العالية تُكسّر الروابط التي تحافظ على شكل الإنزيم (خاصة الرابطة الهيدروجينية)، فيفقد شكله الفعّال — يُسمى 'denaturation'.", t: "الإنزيمات" },
      { q: "ما تأثير الـ pH على نشاط الإنزيم؟", o: ["لا يؤثر", "كل إنزيم له درجة حموضة مثلى", "الإنزيمات تعمل في أي pH", "الـ pH يزيد من تركيز الإنزيم"], c: 1, e: "كل إنزيم له درجة حموضة مثلى (مثل البيبسين pH=2، والتربسين pH=8)، وخارجها يقل النشاط أو يتوقف.", t: "الإنزيمات" },
      { q: "ما درجة الحموضة المثلى لإنزيم البيبسين؟", o: ["7.4", "8.0", "2.0", "12.0"], c: 2, e: "البيبسين يعمل في وسط حمضي جدًا (pH≈2) في المعدة.", t: "الإنزيمات" },
      { q: "ما درجة الحموضة المثلى لإنزيم التربسين؟", o: ["2.0", "7.4", "8.0", "12.0"], c: 2, e: "التربسين يعمل في وسط قلوي خفيف (pH≈8) في الأمعاء الدقيقة.", t: "الإنزيمات" },
      { q: "ما تأثير زيادة تركيز الركيزة على سرعة التفاعل؟", o: ["تزيد السرعة حتى تشبّع الإنزيم", "تنقص السرعة", "لا تؤثر", "تزيد السرعة بشكل غير محدود"], c: 0, e: "مع زيادة الركيزة، تزداد السرعة حتى يتشبع جميع الإنزيمات (Vmax)، ثم لا تزيد السرعة مهما زادت الركيزة.", t: "الإنزيمات" },
      { q: "ما المقصود بـ 'تشبع الإنزيم'؟", o: ["تدمير الإنزيم", "ارتباط جميع جزيئات الإنزيم بالركيزة", "انخفاض درجة الحرارة", "زيادة الـ pH"], c: 1, e: "تشبع الإنزيم = جميع المواقع الفعّالة مشغولة، فتبلغ السرعة أقصاها (Vmax).", t: "الإنزيمات" },
      { q: "ما اسم المادة التي تقلل من نشاط الإنزيم؟", o: ["المنشط", "المثبط", "الركيزة", "المنتج"], c: 1, e: "المثبط (Inhibitor) يرتبط بالإنزيم ويقلل نشاطه (مثل السموم، بعض الأدوية).", t: "الإنزيمات" },
      { q: "ما نوع المثبط الذي يرتبط بالموقع الفعّال؟", o: ["مثبط تنافسي", "مثبط غير تنافسي", "منشط", "ركيزة"], c: 0, e: "المثبط التنافسي يشبه الركيزة ويرتبط بالموقع الفعّال، فيمنع ارتباط الركيزة.", t: "الإنزيمات" },
      { q: "كيف يمكن التغلب على المثبط التنافسي؟", o: ["بخفض درجة الحرارة", "برفع تركيز الركيزة", "بتغيير الـ pH", "بإضافة منشط"], c: 1, e: "بزيادة تركيز الركيزة، تزداد فرصة ارتباطها بالموقع الفعّال بدل المثبط — فيعود النشاط تدريجيًا.", t: "الإنزيمات" }
    ]
  },
  {
    id: 9,
    title: "مراجعة متكاملة (1)",
    questions: [
      { q: "أي عضية توجد في الخلايا الحقيقية النوى فقط؟", o: ["الريبوسوم", "الغشاء البلازمي", "النواة", "السيتوبلازم"], c: 2, e: "النواة المحاطة بغشاء توجد فقط في الخلايا الحقيقية النوى (نباتية، حيوانية، فطرية)، وليس في البدائية.", t: "الخلية" },
      { q: "ما اسم العملية التي يدخل بها الأكسجين إلى الخلايا؟", o: ["الاسموز", "الانتشار", "النقل النشط", "البلعمة"], c: 1, e: "الأكسجين يدخل بالانتشار البسيط من الدم (عالي التركيز) إلى الخلايا (منخفض التركيز).", t: "حركة المواد" },
      { q: "أين يُصنع الإنزيم في الخلية؟", o: ["في الميتوكندريا", "في الريبوسوم", "في جهاز غولجي", "في النواة"], c: 1, e: "الإنزيمات (كالبروتينات) تُصنع في الريبوسومات، ثم تُعدّل في RER وجهاز غولجي.", t: "الخلية" },
      { q: "ما تأثير غلي البيض على الإنزيمات فيه؟", o: ["يزيد نشاطها", "يُ denature الإنزيمات بسبب الحرارة", "لا يؤثر", "يجعلها أكثر تحديدًا"], c: 1, e: "الحرارة العالية (عند السلق) تُ denature بروتينات البيض (بما فيها الإنزيمات)، فتفقد شكلها ووظيفتها.", t: "الإنزيمات" },
      { q: "لماذا تذبل أوراق النبات عند سقيه بماء مالح؟", o: ["لأن الماء المالح يمنع البناء الضوئي", "لأن التربة تصبح مفرطة التوتر فتفقد الخلايا الماء", "لأن الملح يقتل البكتيريا النافعة", "لأن الجذور تمتص الملح فقط"], c: 1, e: "الماء المالح يجعل التربة مفرطة التوتر، فيخرج الماء من جذور النبات بالاسموز، فتفقد الخلايا ضغط الانتفاخ فتذبل.", t: "حركة المواد" },
      { q: "ما اسم الإنزيم المسؤول عن هضم النشا في الفم؟", o: ["البيبسين", "التربسين", "الأميليز", "الليباز"], c: 2, e: "الأميليز اللعابي يبدأ بهضم النشا إلى مالتوز في الفم.", t: "الإنزيمات" },
      { q: "أي خاصية للغشاء البلازمي تجعل الخلية كائنًا منظمًا؟", o: ["كونه صلبًا", "كونه شبه منفذ", "كونه سميكًا", "كونه غير قابل للاختراق"], c: 1, e: "الغشاء شبه المنفذ ينظم دخول وخروج المواد، فيحافظ على بيئة داخلية مستقرة (الاتزان الداخلي).", t: "الخلية" },
      { q: "ما اسم الظاهرة التي تحدث عند وضع خلية نباتية في محلول مفرط التوتر؟", o: ["الانتفاخ", "التحلل", "الانكماش السيتوبلازمي", "الاستقرار"], c: 2, e: "الانكماش السيتوبلازمي: انفصال الغشاء السيتوبلازمي عن الجدار الخلوي بسبب فقدان الماء.", t: "حركة المواد" },
      { q: "ما وظيفة الميتوكندريا في الخلية النباتية؟", o: ["البناء الضوئي فقط", "التنفس الخلوي فقط", "كليهما", "تخزين النشا"], c: 2, e: "الميتوكندريا تقوم بالتنفس الخلوي (تنتج ATP)، بينما البلاستيدة الخضراء تقوم بالبناء الضوئي — وكلاهما في الخلية النباتية.", t: "الخلية" },
      { q: "ما اسم العملية التي تخرج بها الخلية الهرمونات؟", o: ["البلعمة", "الإفراز الخلوي", "الانتشار", "الاسموز"], c: 1, e: "الإفراز الخلوي (Exocytosis) هو خروج المواد المصنعة (مثل الهرمونات) عبر اندماج الحويصلات مع الغشاء.", t: "حركة المواد" },
      { q: "ما تأثير المثبط غير التنافسي على Vmax؟", o: ["يزيد Vmax", "يقلل Vmax", "لا يؤثر على Vmax", "يجعل Vmax غير محدد"], c: 1, e: "المثبط غير التنافسي يرتبط بموقع آخر في الإنزيم فيغير شكل الموقع الفعّال، فيقلل Vmax ولا يمكن التغلب عليه بزيادة الركيزة.", t: "الإنزيمات" }
    ]
  },
  {
    id: 10,
    title: "مراجعة متكاملة (2)",
    questions: [
      { q: "أي من التالي لا ينطبق على الخلايا البدائية؟", o: ["لا نواة", "DNA دائري", "عضيات غشائية", "أصغر حجمًا من الحقيقية"], c: 2, e: "الخلايا البدائية لا تحتوي عضيات غشائية (مثل ميتوكندريا، نواة)، بينما الحقيقية تحتويها.", t: "الخلية" },
      { q: "ما اسم الغشاء الذي يفصل محتويات الخلية عن الوسط الخارجي؟", o: ["الغشاء النووي", "الغشاء البلازمي", "غشاء الميتوكندريا", "غشاء الشبكة الإندوبلازمية"], c: 1, e: "الغشاء البلازمي هو الغشاء الخارجي للخلية، وينظم دخول وخروج المواد.", t: "الخلية" },
      { q: "ما تأثير نقص الأكسجين على النقل النشط؟", o: ["يزيد النشاط", "يقلل النشاط بسبب نقص ATP", "لا يؤثر", "يغير نوع النقل"], c: 1, e: "النقل النشط يحتاج ATP، ونقص الأكسجين يقلل التنفس الهوائي فيقل إنتاج ATP، فيقل النقل النشط.", t: "حركة المواد" },
      { q: "أين توجد مضخة الصوديوم-البوتاسيوم؟", o: ["في الغشاء البلازمي", "في الغشاء النووي", "في غشاء الميتوكندريا", "في غشاء الشبكة الإندوبلازمية"], c: 0, e: "المضخة موجودة في الغشاء البلازمي لمعظم الخلايا الحيوانية.", t: "حركة المواد" },
      { q: "ما اسم الإنزيم الذي يحطم الدهون؟", o: ["الأميليز", "البروتيز", "الليباز", "السليلاز"], c: 2, e: "الليباز يهضم الدهون (الثلاثي جليسريد) إلى أحماض دهنية وغليسيرول.", t: "الإنزيمات" },
      { q: "ما اسم العملية التي يدخل بها الجلوكوز إلى الخلايا العضلية؟", o: ["الانتشار البسيط", "الانتشار الميسر", "النقل النشط", "البلعمة"], c: 1, e: "الجلوكوز يدخل بالانتشار الميسر عبر نواقل بروتينية (مثل GLUT4)، مع التدرج ولا يحتاج طاقة.", t: "حركة المواد" },
      { q: "ما تأثير إضافة حمض قوي على إنزيم البيبسين؟", o: ["يقلل النشاط", "يزيد النشاط (لأنه مثالي لـ pH منخفض)", "لا يؤثر", "ي denature الإنزيم"], c: 1, e: "البيبسين مثالي في pH منخفض (حمضي)، لذا إضافة حمض يزيد نشاطه (ضمن الحدود).", t: "الإنزيمات" },
      { q: "ما اسم العضية التي تصنع ATP في الظلام للنبات؟", o: ["البلاستيدة الخضراء", "الميتوكندريا", "الشبكة الإندوبلازمية", "الريبوسوم"], c: 1, e: "في الظلام، البلاستيدة لا تعمل، فتنتج الميتوكندريا ATP عبر التنفس الخلوي.", t: "الخلية" },
      { q: "ما اسم الظاهرة التي تحدث عند وضع بيضة منزوعة القشرة في ماء نقي؟", o: ["تتقلص", "تنتفخ وتنفجر", "لا يتأثر حجمها", "تتجمد"], c: 1, e: "الماء يدخل البيضة (لأن محتواها مفرط التوتر)، فتنتفخ وتنفجر — تحلل.", t: "حركة المواد" },
      { q: "ما اسم الإنزيم الذي يفرزه البنكرياس لهضم البروتين؟", o: ["البيبسين", "التربسين", "الأميليز", "الليباز"], c: 1, e: "التربسين (في صورة تربسينوجين) يفرز من البنكرياس، وينشط في الأمعاء لهضم البروتين.", t: "الإنزيمات" },
      { q: "ما اسم الجزيئات التي تنتجها الميتوكندريا؟", o: ["DNA", "ATP", "RNA", "كل ما سبق"], c: 3, e: "الميتوكندريا تنتج ATP، ولها DNA وريبوسومات خاصة بها (تُنتج بعض بروتيناتها).", t: "الخلية" }
    ]
  }
];

// الرابط المخفي
const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLScSRNyZEAt5lfuSzIkMaQUMdSOdv-jOhX3AiIdT8F0GIQgFSA/viewform?usp=header";

export default function App() {
  const [currentBlock, setCurrentBlock] = useState(0);
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [answers, setAnswers] = useState({});
  const [showResults, setShowResults] = useState(false);
  const [timeLeft, setTimeLeft] = useState(20 * 60);
  const [showPromoModal, setShowPromoModal] = useState(false);

  const block = BLOCKS[currentBlock];
  const question = block.questions[currentQuestion];
  const userAnswer = answers[`block-${block.id}`]?.[currentQuestion];

  // Timer
  useEffect(() => {
    if (showResults || timeLeft <= 0) return;
    const timer = setInterval(() => {
      setTimeLeft(prev => Math.max(0, prev - 1));
    }, 1000);
    return () => clearInterval(timer);
  }, [showResults, timeLeft]);

  const handleAnswerSelect = (optionIndex) => {
    setAnswers(prev => ({
      ...prev,
      [`block-${block.id}`]: {
        ...prev[`block-${block.id}`],
        [currentQuestion]: optionIndex
      }
    }));
  };

  const handleNextQuestion = () => {
    if (currentQuestion < block.questions.length - 1) {
      setCurrentQuestion(prev => prev + 1);
    } else {
      handleSubmitBlock();
    }
  };

  const handlePrevQuestion = () => {
    if (currentQuestion > 0) {
      setCurrentQuestion(prev => prev - 1);
    }
  };

  const handleSubmitBlock = () => {
    setShowResults(true);
  };

  const goToNextBlock = () => {
    if (currentBlock < BLOCKS.length - 1) {
      const nextBlock = currentBlock + 1;
      // Show promo modal when moving to part 3 or beyond
      if (nextBlock >= 2) {
        setShowPromoModal(true);
      }
      setCurrentBlock(nextBlock);
      setCurrentQuestion(0);
      setShowResults(false);
      setTimeLeft(20 * 60);
    }
  };

  const restartBlock = () => {
    setAnswers(prev => {
      const newAnswers = { ...prev };
      delete newAnswers[`block-${block.id}`];
      return newAnswers;
    });
    setCurrentQuestion(0);
    setShowResults(false);
    setTimeLeft(20 * 60);
  };

  const calculateBlockScore = () => {
    const blockAnswers = answers[`block-${block.id}`] || {};
    let correct = 0;
    block.questions.forEach((q, idx) => {
      if (blockAnswers[idx] === q.c) correct++;
    });
    return Math.round((correct / block.questions.length) * 100);
  };

  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  };

  // Handle part selection (show modal for parts 3+)
  const handlePartSelect = (index) => {
    if (index >= 2) { // Part 3+ (0-indexed: 2 = Part 3)
      setShowPromoModal(true);
    }
    setCurrentBlock(index);
    setCurrentQuestion(0);
    setShowResults(false);
    setTimeLeft(20 * 60);
  };

  // Open form in new tab
  const handleOpenForm = () => {
    window.open(FORM_URL, '_blank');
    setShowPromoModal(false);
  };

  // Results View
  if (showResults) {
    const score = calculateBlockScore();
    const blockAnswers = answers[`block-${block.id}`] || {};

    return (
      <div className="min-h-screen bg-gradient-to-br from-blue-50 to-cyan-100 p-4 md:p-6" dir="rtl">
        <div className="max-w-5xl mx-auto">
          <div className="text-center mb-6">
            <div className="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4">
              <Trophy className="w-8 h-8 text-green-600" />
            </div>
            <h1 className="text-2xl font-bold text-gray-800">نتائج الجزء {block.id}</h1>
            <p className="text-gray-600">{block.title}</p>
          </div>

          <div className="bg-white rounded-2xl shadow-xl p-6 mb-8 text-center">
            <div className="inline-flex items-center justify-center w-24 h-24 rounded-full bg-blue-50 mb-4">
              <span className="text-4xl font-bold text-blue-700">{score}%</span>
            </div>
            <h2 className="text-xl font-semibold text-gray-800">
              {score >= 90 ? 'ممتاز 🌟' : score >= 75 ? 'جيد جدًا 👍' : score >= 60 ? 'جيد 👌' : 'يحتاج مراجعة 📚'}
            </h2>
            <p className="text-gray-600 mt-2">
              أجبت على {Object.keys(blockAnswers).length} من {block.questions.length} أسئلة
            </p>
          </div>

          <div className="bg-white rounded-xl shadow-lg p-5 mb-8">
            <h3 className="text-lg font-bold text-gray-800 flex items-center mb-4">
              <HelpCircle className="ml-2 w-5 h-5" />
              مراجعة الأسئلة
            </h3>
            <div className="space-y-5">
              {block.questions.map((q, idx) => {
                const ans = blockAnswers[idx];
                const isCorrect = ans === q.c;
                return (
                  <div key={idx} className="border-r-4 border-blue-100 pr-4">
                    <div className="flex">
                      <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ml-3 mt-1 ${
                        isCorrect ? 'bg-green-100 text-green-700' : ans !== undefined ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-500'
                      }`}>
                        {isCorrect ? <CheckCircle size={16} /> : ans !== undefined ? <XCircle size={16} /> : '?'}
                      </div>
                      <div>
                        <p className="font-medium text-gray-800">
                          <span className="font-bold text-blue-600">س{idx + 1}:</span> {q.q}
                        </p>
                        {ans !== undefined && (
                          <div className="mt-2 text-sm">
                            <p className="text-gray-600">
                              <span className="font-medium">إجابتك:</span> {q.o[ans]}
                            </p>
                            <p className="text-gray-600">
                              <span className="font-medium">الإجابة الصحيحة:</span> {q.o[q.c]}
                            </p>
                            <div className="mt-2 p-3 bg-gray-50 rounded-lg">
                              <p className="text-sm text-gray-700">
                                <span className="font-medium">التفسير:</span> {q.e}
                              </p>
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>

          <div className="flex flex-col sm:flex-row justify-center gap-4">
            <button
              onClick={restartBlock}
              className="flex items-center justify-center px-6 py-3 bg-blue-600 text-white font-bold rounded-full hover:bg-blue-700 transition"
            >
              <RotateCcw className="ml-2 w-4 h-4" />
              إعادة الجزء
            </button>
            {currentBlock < BLOCKS.length - 1 && (
              <button
                onClick={goToNextBlock}
                className="flex items-center justify-center px-6 py-3 bg-emerald-600 text-white font-bold rounded-full hover:bg-emerald-700 transition"
              >
                <ChevronRight className="ml-2 w-4 h-4" />
                الجزء التالي ({currentBlock + 2})
              </button>
            )}
          </div>

          <div className="mt-8 text-center text-sm text-gray-500">
            الجزء {currentBlock + 1} من {BLOCKS.length}
          </div>

          {/* Promotional Banner */}
          <div className="mt-8 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-2xl p-6 text-white">
            <div className="flex items-center">
              <Gift className="w-8 h-8 mr-3 flex-shrink-0" />
              <div>
                <h3 className="text-xl font-bold">✨ احصل على المحتوى الكامل!</h3>
                <p className="mt-2">
                  بنك أسئلة شامل مع الإجابات والشرح • تقييم دقيق لمستواك • خطة مخصصة للتحسين
                </p>
                <button
                  onClick={handleOpenForm}
                  className="inline-flex items-center mt-3 bg-white text-blue-600 font-bold py-2 px-4 rounded-lg hover:bg-blue-50"
                >
                  <ExternalLink className="ml-2 w-4 h-4" />
                  املأ النموذج للإكمال
                </button>
              </div>
            </div>
          </div>
        </div>

        {/* Promotional Modal */}
        {showPromoModal && (
          <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-2xl max-w-md w-full p-6 md:p-8 shadow-2xl relative">
              <button 
                onClick={() => setShowPromoModal(false)}
                className="absolute top-4 left-4 text-gray-400 hover:text-gray-600 text-2xl"
              >
                &times;
              </button>
              <div className="text-center">
                <div className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-full mx-auto mb-4">
                  <Gift className="w-8 h-8 text-white" />
                </div>
                <h2 className="text-2xl font-bold text-gray-800 mb-3">✨ احصل على المحتوى الكامل!</h2>
                <div className="bg-blue-50 border-r-4 border-blue-500 rounded-lg p-4 mb-5 text-right">
                  <p className="text-gray-800 font-medium">
                    احصل على كل البنك والامتحانات مع الاجابة والشرح، احصل على تقييم مستواك و تحسينه.
                  </p>
                  <p className="text-gray-700 mt-2">
                    قم بإملاء النموذج للإكمال ، وبمجرد أن يكمل النموذج افتح له كل المجموعات والأسئلة
                  </p>
                </div>
                
                <button
                  onClick={handleOpenForm}
                  className="inline-flex items-center justify-center w-full bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-700 hover:to-cyan-700 shadow-lg mb-4"
                >
                  <ExternalLink className="ml-2 w-5 h-5" />
                  املأ النموذج للإكمال
                </button>
                
                <button
                  onClick={() => setShowPromoModal(false)}
                  className="inline-flex items-center justify-center w-full bg-gray-200 text-gray-700 font-bold py-3 px-6 rounded-xl hover:bg-gray-300 mt-2"
                >
                  <Check className="ml-2 w-5 h-5" />
                  المتابعة بدون إكمال النموذج
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-cyan-100 p-4 md:p-6" dir="rtl">
      <div className="max-w-4xl mx-auto">
        {/* Promotional Banner at Top */}
        <div className="bg-gradient-to-r from-blue-500 to-cyan-600 rounded-2xl p-4 mb-6 text-white">
          <div className="flex flex-col md:flex-row items-center">
            <Gift className="w-8 h-8 mr-3 mb-2 md:mb-0 flex-shrink-0" />
            <div className="text-center md:text-right flex-1">
              <h3 className="text-lg md:text-xl font-bold">✨ احصل على المحتوى الكامل!</h3>
              <p className="text-sm md:text-base mt-1">
                بنك أسئلة شامل مع الإجابات والشرح • تقييم دقيق لمستواك • خطة مخصصة للتحسين
              </p>
            </div>
            <button
              onClick={handleOpenForm}
              className="mt-3 md:mt-0 md:ml-4 bg-white text-blue-600 font-bold py-2 px-4 rounded-lg hover:bg-blue-50 inline-flex items-center justify-center"
            >
              <ExternalLink className="ml-2 w-4 h-4" />
              املأ النموذج للإكمال
            </button>
          </div>
        </div>

        {/* Header */}
        <div className="text-center mb-6">
          <div className="inline-flex items-center justify-center w-14 h-14 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-2xl mb-4">
            <BookOpen className="w-7 h-7 text-white" />
          </div>
          <h1 className="text-2xl md:text-3xl font-bold text-gray-800">امتحان الأحياء — الصف العاشر</h1>
          <p className="text-gray-600 mt-1">الفصل الدراسي الأول — الفترة الأولى (منهج الكويت 2024–2025)</p>
          <div className="mt-3 text-sm text-blue-700 font-medium">
            الجزء {currentBlock + 1}: {block.title}
          </div>
        </div>

        {/* Progress & Timer */}
        <div className="bg-white rounded-xl shadow-md p-4 mb-6 flex flex-col sm:flex-row justify-between items-center">
          <div className="flex items-center">
            <div className="w-32 h-2 bg-gray-200 rounded-full overflow-hidden">
              <div 
                className="h-full bg-blue-600 rounded-full" 
                style={{ width: `${((currentQuestion + 1) / block.questions.length) * 100}%` }}
              />
            </div>
            <span className="mr-3 font-medium text-gray-700">
              سؤال {currentQuestion + 1} من {block.questions.length}
            </span>
          </div>
          <div className="flex items-center mt-3 sm:mt-0">
            <Timer className="ml-2 w-5 h-5 text-red-500" />
            <span className="font-mono font-bold text-red-600">{formatTime(timeLeft)}</span>
          </div>
        </div>

        {/* Question Card */}
        <div className="bg-white rounded-2xl shadow-xl overflow-hidden">
          <div className="p-5 md:p-7">
            <div className="flex items-start mb-6">
              <span className="flex-shrink-0 w-9 h-9 rounded-full bg-blue-100 text-blue-800 flex items-center justify-center font-bold text-sm ml-3">
                {currentQuestion + 1}
              </span>
              <h2 className="text-lg md:text-xl font-semibold text-gray-800 leading-relaxed">
                {question.q}
              </h2>
            </div>

            {/* Options */}
            <div className="space-y-3">
              {question.o.map((option, idx) => (
                <button
                  key={idx}
                  onClick={() => handleAnswerSelect(idx)}
                  className={`w-full text-right p-4 rounded-xl border-2 transition-all duration-200 ${
                    userAnswer === idx
                      ? 'border-blue-500 bg-blue-50 text-blue-800 font-medium shadow-sm'
                      : 'border-gray-200 hover:border-blue-300 hover:bg-blue-50'
                  }`}
                >
                  <span className="font-medium ml-2">{String.fromCharCode(65 + idx)}.</span>
                  {option}
                </button>
              ))}
            </div>

            {/* Navigation */}
            <div className="mt-8 flex flex-col sm:flex-row justify-between items-center gap-4">
              <div className="flex space-x-3 space-x-reverse">
                <button
                  onClick={handlePrevQuestion}
                  disabled={currentQuestion === 0}
                  className={`px-5 py-2.5 rounded-xl font-medium flex items-center ${
                    currentQuestion === 0
                      ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                      : 'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'
                  }`}
                >
                  <ChevronLeft className="ml-1 w-4 h-4" />
                  السابق
                </button>
                <button
                  onClick={handleNextQuestion}
                  disabled={userAnswer === undefined}
                  className={`px-5 py-2.5 rounded-xl font-medium flex items-center ${
                    userAnswer === undefined
                      ? 'bg-gray-100 text-gray-400 cursor-not-allowed'
                      : 'bg-gradient-to-r from-blue-600 to-cyan-600 text-white hover:from-blue-700 hover:to-cyan-700 shadow-md'
                  }`}
                >
                  {currentQuestion === block.questions.length - 1 ? 'إنهاء الجزء' : 'التالي'}
                  <ChevronRight className="mr-1 w-4 h-4" />
                </button>
              </div>

              <div className="text-sm text-gray-500 text-center sm:text-right">
                {userAnswer === undefined ? 'اختر إجابة للاستمرار' : '✓ جاهز للانتقال'}
              </div>
            </div>
          </div>
        </div>

        {/* Part Selector */}
        <div className="mt-8">
          <h3 className="text-lg font-semibold text-gray-800 mb-3 flex items-center">
            <BookOpen className="ml-2 w-5 h-5" />
            اختيار جزء
          </h3>
          <div className="grid grid-cols-2 sm:grid-cols-5 gap-3">
            {BLOCKS.map((b, idx) => (
              <button
                key={b.id}
                onClick={() => handlePartSelect(idx)}
                className={`px-3 py-2 text-sm rounded-lg font-medium ${
                  currentBlock === idx
                    ? 'bg-blue-600 text-white'
                    : answers[`block-${b.id}`]
                    ? 'bg-green-100 text-green-800'
                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                }`}
              >
                <span>الجزء {b.id}</span>
                {answers[`block-${b.id}`] && ' ✓'}
              </button>
            ))}
          </div>
        </div>

        <div className="mt-6 text-center text-xs text-gray-500">
          جميع الأسئلة مأخوذة من منهج الكويت الرسمي — الفترة الأولى فقط (بدون أي محتوى من الفصل الثاني)
        </div>

        {/* Promotional Modal */}
        {showPromoModal && (
          <div className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4">
            <div className="bg-white rounded-2xl max-w-md w-full p-6 md:p-8 shadow-2xl relative">
              <button 
                onClick={() => setShowPromoModal(false)}
                className="absolute top-4 left-4 text-gray-400 hover:text-gray-600 text-2xl"
              >
                &times;
              </button>
              <div className="text-center">
                <div className="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-full mx-auto mb-4">
                  <Gift className="w-8 h-8 text-white" />
                </div>
                <h2 className="text-2xl font-bold text-gray-800 mb-3">✨ احصل على المحتوى الكامل!</h2>
                <div className="bg-blue-50 border-r-4 border-blue-500 rounded-lg p-4 mb-5 text-right">
                  <p className="text-gray-800 font-medium">
                    احصل على كل البنك والامتحانات مع الاجابة والشرح، احصل على تقييم مستواك و تحسينه.
                  </p>
                  <p className="text-gray-700 mt-2">
                    قم بإملاء النموذج للإكمال ، وبمجرد أن يكمل النموذج افتح له كل المجموعات والأسئلة
                  </p>
                </div>
                
                <button
                  onClick={handleOpenForm}
                  className="inline-flex items-center justify-center w-full bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-bold py-3 px-6 rounded-xl hover:from-blue-700 hover:to-cyan-700 shadow-lg mb-4"
                >
                  <ExternalLink className="ml-2 w-5 h-5" />
                  املأ النموذج للإكمال
                </button>
                
                <button
                  onClick={() => setShowPromoModal(false)}
                  className="inline-flex items-center justify-center w-full bg-gray-200 text-gray-700 font-bold py-3 px-6 rounded-xl hover:bg-gray-300 mt-2"
                >
                  <Check className="ml-2 w-5 h-5" />
                  المتابعة بدون إكمال النموذج
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}


