(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6992:function(e,s,t){Promise.resolve().then(t.bind(t,2615))},2615:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return _}});var a={};t.r(a);var l=t(7437),r=t(2265),i=t(5671),n=t(575),o=t(9917),d=t(2126),c=t(1016),u=t(5829),h=t(5790),m=t(9883),x=t(7842),g=t(998),v=t(6654),j=t(8203),f=t(4660),p=t(4810),N=t(4829),y=t(5925);let w="http://localhost:8080/api/v1";class b{getAuthToken(){return localStorage.getItem("access_token")}getRefreshToken(){return localStorage.getItem("refresh_token")}setTokens(e,s){localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",s)}clearTokens(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}generateRequestId(){return"req_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}async refreshToken(){let e=this.getRefreshToken();if(!e)throw Error("No refresh token available");try{let{accessToken:s,refreshToken:t}=(await N.Z.post("".concat(w,"/auth/refresh"),{refreshToken:e})).data.data.tokens;this.setTokens(s,t)}catch(e){throw Error("Failed to refresh token")}}handleAuthError(){this.clearTokens(),y.Am.error("Your session has expired. Please log in again."),window.location.href="/login"}handleError(e){var s,t,a,l;let r=(null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:null===(s=t.error)||void 0===s?void 0:s.message)||"An unexpected error occurred";(null===(l=e.response)||void 0===l?void 0:l.status)!==401&&y.Am.error(r)}async get(e,s){return(await this.client.get(e,s)).data}async post(e,s,t){return(await this.client.post(e,s,t)).data}async put(e,s,t){return(await this.client.put(e,s,t)).data}async patch(e,s,t){return(await this.client.patch(e,s,t)).data}async delete(e,s){return(await this.client.delete(e,s)).data}async getPaginated(e,s){return(await this.client.get(e,{params:s})).data}async uploadFile(e,s,t){let a=new FormData;return a.append("file",s),(await this.client.post(e,a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{t&&e.total&&t(Math.round(100*e.loaded/e.total))}})).data}async uploadFiles(e,s,t){let a=new FormData;return s.forEach((e,s)=>{a.append("files[".concat(s,"]"),e)}),(await this.client.post(e,a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{t&&e.total&&t(Math.round(100*e.loaded/e.total))}})).data}constructor(){this.client=N.Z.create({baseURL:w,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),this.client.interceptors.request.use(e=>{let s=this.getAuthToken();return s&&(e.headers.Authorization="Bearer ".concat(s)),e.headers["X-Request-ID"]=this.generateRequestId(),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var s;let t=e.config;if((null===(s=e.response)||void 0===s?void 0:s.status)===401&&!t._retry){t._retry=!0;try{await this.refreshToken();let e=this.getAuthToken();if(e)return t.headers.Authorization="Bearer ".concat(e),this.client(t)}catch(e){return this.handleAuthError(),Promise.reject(e)}}return this.handleError(e),Promise.reject(e)})}}new b;let k=(0,f.Ue)()((0,p.tJ)((e,s)=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,login:async s=>{e({isLoading:!0,error:null});try{let{user:t,tokens:l}=(await a.apiClient.post("/auth/login",s)).data;a.apiClient.defaults.headers.common.Authorization="Bearer ".concat(l.accessToken),e({user:t,isAuthenticated:!0,isLoading:!1,error:null})}catch(a){var t,l,r;let s=(null===(r=a.response)||void 0===r?void 0:null===(l=r.data)||void 0===l?void 0:null===(t=l.error)||void 0===t?void 0:t.message)||"Login failed";throw e({isLoading:!1,error:s}),Error(s)}},register:async s=>{e({isLoading:!0,error:null});try{await a.apiClient.post("/auth/register",s),e({isLoading:!1,error:null})}catch(a){var t,l,r;let s=(null===(r=a.response)||void 0===r?void 0:null===(l=r.data)||void 0===l?void 0:null===(t=l.error)||void 0===t?void 0:t.message)||"Registration failed";throw e({isLoading:!1,error:s}),Error(s)}},logout:()=>{delete a.apiClient.defaults.headers.common.Authorization,e({user:null,isAuthenticated:!1,error:null})},refreshToken:async()=>{let{user:e}=s();if(e)try{let{accessToken:e}=(await a.apiClient.post("/auth/refresh")).data;a.apiClient.defaults.headers.common.Authorization="Bearer ".concat(e)}catch(e){s().logout()}},clearError:()=>{e({error:null})},setLoading:s=>{e({isLoading:s})}}),{name:"auth-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated}),onRehydrateStorage:()=>e=>{(null==e?void 0:e.isAuthenticated)&&(null==e?void 0:e.user)&&(a.apiClient.defaults.headers.common.Authorization="Bearer stored-token")}}));var C=t(6292);function _(){let{user:e,logout:s}=k(),[t,a]=(0,r.useState)(null),[f,p]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{(async()=>{p(!0);try{var e,s,t,l,r,i,n,o,d,c,u,h,m,x,g,v,j,f,N;let[p,y,w]=await Promise.all([C.xS.getNutritionSummary(7),C.ke.getFitnessSummary(7),C.MO.getProgressSummary(7)]);a({totalCaloriesConsumed:(null===(e=p.data)||void 0===e?void 0:e.total_calories)||0,totalCaloriesBurned:(null===(s=y.data)||void 0===s?void 0:s.calories_burned)||0,netCalories:((null===(t=p.data)||void 0===t?void 0:t.total_calories)||0)-((null===(l=y.data)||void 0===l?void 0:l.calories_burned)||0),waterIntake:(null===(r=p.data)||void 0===r?void 0:r.water_intake)||0,workoutsCompleted:(null===(i=y.data)||void 0===i?void 0:i.total_workouts)||0,activeStreak:(null===(n=y.data)||void 0===n?void 0:n.streak)||0,currentWeight:(null===(d=w.data)||void 0===d?void 0:null===(o=d.latest)||void 0===o?void 0:o.weight)||0,goalProgress:{calories:(null===(u=p.data)||void 0===u?void 0:null===(c=u.goal_progress)||void 0===c?void 0:c.calories)||0,protein:(null===(m=p.data)||void 0===m?void 0:null===(h=m.goal_progress)||void 0===h?void 0:h.protein)||0,carbs:(null===(g=p.data)||void 0===g?void 0:null===(x=g.goal_progress)||void 0===x?void 0:x.carbs)||0,fat:(null===(j=p.data)||void 0===j?void 0:null===(v=j.goal_progress)||void 0===v?void 0:v.fat)||0},recentActivities:{meals:(null===(f=p.data)||void 0===f?void 0:f.recent_meals)||[],workouts:(null===(N=y.data)||void 0===N?void 0:N.recent_workouts)||[],activities:[]}})}catch(e){console.error("Failed to load dashboard data:",e),a({totalCaloriesConsumed:1850,totalCaloriesBurned:420,netCalories:1430,waterIntake:2e3,workoutsCompleted:2,activeStreak:7,currentWeight:75.5,goalProgress:{calories:85,protein:92,carbs:78,fat:88},recentActivities:{meals:[],workouts:[],activities:[]}})}finally{p(!1)}})()},[]),f)?(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("nav",{className:"bg-white shadow-sm border-b",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between h-16",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(o.Z,{className:"h-8 w-8 text-green-600 mr-3"}),(0,l.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"NutriFit"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:["Welcome back, ",null==e?void 0:e.firstName,"!"]}),(0,l.jsx)(n.z,{variant:"outline",onClick:s,children:"Sign Out"})]})]})})}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsxs)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Welcome back, ",null==e?void 0:e.firstName,"!"]}),(0,l.jsx)("p",{className:"text-gray-600",children:"Here's your health and fitness overview for today."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ll,{className:"text-sm font-medium",children:"Calories Consumed"}),(0,l.jsx)(d.Z,{className:"h-4 w-4 text-green-600"})]}),(0,l.jsxs)(i.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:null==t?void 0:t.totalCaloriesConsumed}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"of 2,200 daily goal"}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,l.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"".concat(Math.round(((null==t?void 0:t.totalCaloriesConsumed)||0)/2200*100),"%")}})})]})]}),(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ll,{className:"text-sm font-medium",children:"Calories Burned"}),(0,l.jsx)(c.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,l.jsxs)(i.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:null==t?void 0:t.totalCaloriesBurned}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"active today"}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,l.jsx)("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:"".concat(Math.round(((null==t?void 0:t.totalCaloriesBurned)||0)/500*100),"%")}})})]})]}),(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ll,{className:"text-sm font-medium",children:"Water Intake"}),(0,l.jsx)(u.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,l.jsxs)(i.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",children:[null==t?void 0:t.waterIntake,"ml"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"of 2,500ml daily goal"}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(Math.round(((null==t?void 0:t.waterIntake)||0)/2500*100),"%")}})})]})]}),(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(i.ll,{className:"text-sm font-medium",children:"Active Streak"}),(0,l.jsx)(h.Z,{className:"h-4 w-4 text-purple-600"})]}),(0,l.jsxs)(i.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold",children:[null==t?void 0:t.activeStreak," days"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600",children:"keep it up!"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{children:[(0,l.jsx)(i.ll,{children:"Quick Actions"}),(0,l.jsx)(i.SZ,{children:"Log your meals and workouts quickly"})]}),(0,l.jsxs)(i.aY,{className:"space-y-4",children:[(0,l.jsxs)(n.z,{className:"w-full justify-start",variant:"outline",children:[(0,l.jsx)(m.Z,{className:"h-4 w-4 mr-2"}),"Log Meal"]}),(0,l.jsxs)(n.z,{className:"w-full justify-start",variant:"outline",children:[(0,l.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Log Workout"]}),(0,l.jsxs)(n.z,{className:"w-full justify-start",variant:"outline",children:[(0,l.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Log Water Intake"]}),(0,l.jsxs)(n.z,{className:"w-full justify-start",variant:"outline",children:[(0,l.jsx)(g.Z,{className:"h-4 w-4 mr-2"}),"Log Weight"]})]})]}),(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{children:[(0,l.jsx)(i.ll,{children:"Goals Progress"}),(0,l.jsx)(i.SZ,{children:"Your daily macro nutrient goals"})]}),(0,l.jsxs)(i.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Protein"}),(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:[null==t?void 0:t.goalProgress.protein,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-red-600 h-2 rounded-full",style:{width:"".concat(null==t?void 0:t.goalProgress.protein,"%")}})})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Carbs"}),(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:[null==t?void 0:t.goalProgress.carbs,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-yellow-600 h-2 rounded-full",style:{width:"".concat(null==t?void 0:t.goalProgress.carbs,"%")}})})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"Fat"}),(0,l.jsxs)("span",{className:"text-sm text-gray-600",children:[null==t?void 0:t.goalProgress.fat,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(null==t?void 0:t.goalProgress.fat,"%")}})})]}),(0,l.jsx)("div",{className:"pt-4 border-t",children:(0,l.jsxs)(n.z,{className:"w-full",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"Adjust Goals"]})})]})]})]}),(0,l.jsxs)(i.Zb,{children:[(0,l.jsxs)(i.Ol,{children:[(0,l.jsx)(i.ll,{children:"Recent Activity"}),(0,l.jsx)(i.SZ,{children:"Your latest nutrition and fitness activities"})]}),(0,l.jsxs)(i.aY,{children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(d.Z,{className:"h-5 w-5 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"Breakfast"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Oatmeal with berries"})]})]}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"420 cal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(x.Z,{className:"h-5 w-5 text-orange-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"Morning Workout"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"30 min cardio"})]})]}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"250 cal"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(d.Z,{className:"h-5 w-5 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:"Lunch"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Grilled chicken salad"})]})]}),(0,l.jsx)("span",{className:"text-sm font-medium",children:"580 cal"})]})]}),(0,l.jsxs)(n.z,{variant:"outline",className:"w-full mt-4",children:[(0,l.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"View Full History"]})]})]})]})]})}}},function(e){e.O(0,[14,438,290,971,938,744],function(){return e(e.s=6992)}),_N_E=e.O()}]);